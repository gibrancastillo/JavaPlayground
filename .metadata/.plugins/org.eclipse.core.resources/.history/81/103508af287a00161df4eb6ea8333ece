package com.ccc.rest.client;

import javax.ws.rs.client.Client;
import javax.ws.rs.client.ClientBuilder;
import javax.ws.rs.client.Invocation.Builder;
import javax.ws.rs.client.WebTarget;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import com.ccc.messenger.model.Message;

public class RestApiClient {
	
	public static void main(String[] args) {
		/*
		 * JAX-RS provides the javax.ws.rs.client.Client interface to build and make 'fluent' REST Web Service API calls.
		 * YOu need to ask JAX-RS for an implementation of Client, to do that is by using javax.ws.rs.client.ClientBuilder.
		 */
		Client client = ClientBuilder.newClient();
		
		/*
		 * Build and make 'fluent' REST Web Service API calls
		 * 1. Specify the target URL endpoint
		 * 2. Build an HTTP Request using appropriate HTTP Method.
		 * 3. Capture HTTP Response in JAX-RS javax.ws.rs.core.Response object.
		 */
		// Using method chaining
		/*Response response = client
				.target("http://localhost:8080/advanced-jaxrs-01/webapi/messages/1")
				.request()
				.get();*/
		
		/*
		 * The .request() takes the media type you want the REST API to produce; therefore, this value is added to the HTTP Header 'Accept = application/json' in the HTTP Request
		 * The .get() has several signatures, one of them allows you to pass the class or data type you expect the HTTP Response
		 */
		Message message = client
				.target("http://localhost:8080/advanced-jaxrs-01/webapi/messages/1")
				.request(MediaType.APPLICATION_JSON)
				.get(Message.class);
		
		// Using WebTarget, Builder and Response
		/*WebTarget target = client.target("http://localhost:8080/advanced-jaxrs-01/webapi/messages/1");
		Builder request = target.request();
		Response response = request.get();*/
		
		// To get the JSON message from the response you use the readEntity method and pass the class you are expecting as a response, in this case Message.class
		//Message message = response.readEntity(Message.class);
		System.out.println(message.getMessage());
	}
}